{% extends "base.html" %}
{% block content %}

You are on the main page.

{% if logged %}
    Welcome {{ user }}! 

{% else %}

    <h1>Login</h1>
    <form id="login_form" method='POST'>
        Username<input id='username_input' type='text' name='username'><br>
        Password<input id='password_input' type='password' name='password'><br>
        <input id='login_submit' type='submit' value='Login'><br>
    </form>
    <script>

        $(document).ready(function(){
            $('#login_form').submit(function(event){
                
                event.preventDefault();

                //Get the data from the form and put it into an object
                var formData = {
                    "username": $("#username_input").val(),
                    "password": $("#password_input").val()
                };
                //Submit a post request using ajax
                $.ajax({
                    type: 'POST',
                    url: 'http://localhost:5000/api/login', //This is the url we want to send the data to
                    contentType: "application/json", //We need to do this so api can parse the data
                    data: JSON.stringify(formData), //^
                    dataType: 'json', //We want to get json data back from the server
                    
                    //On success, reload the window
                    success: function(data){
                        window.location.href = 'http:localhost:5000/';
                        return;
                    },
                    error: function(data){
                        alert('error');
                        console.log(data);
                    }
                });
            });
        });
    </script>

    <h1>Don't have an account? Please Sign Up!</h1>
    <p class="center">
    </p>

    <form id = "new_user" method = 'POST'>
        Username<input id = "new_username_input" type = "text" name = "username"><br>
        First name<input id = "new_firstname_input" type = "text" name = "firstname"><br>
        Last name<input id = "new_lastname_input" type = "text" name = "lastname"><br>
        Password<input id = "new_password1_input" type = "password" name = "password1"><br>
        Verify password<input id = "new_password2_input" type = "password" name = "password2"><br>
        Email<input id = "new_email_input" type = "text" name = "email"><br>
        <input id = "new_submit" type = "submit" value = "Sign up"><br>
    </form>

{% endif %}

{% endblock %}